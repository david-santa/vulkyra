package models

import (
	"github.com/google/uuid"
	"gorm.io/datatypes"
)

// Make sure you have Postgres and GORM's datatypes imported!

type Vulnerability struct {
	ID           uuid.UUID      `gorm:"type:uuid;default:gen_random_uuid();primaryKey" json:"id"`
	AssetID      uuid.UUID      `gorm:"type:uuid;not null" json:"asset_id"`
	AssetName    string         `gorm:"-" json:"asset_name"` // Not stored; loaded on query
	PluginID     int            `json:"plugin_id"`
	PluginName   string         `json:"plugin_name"`
	PluginFamily string         `json:"plugin_family"`
	Port         int            `json:"port"`
	Protocol     string         `json:"protocol"`
	Service      string         `json:"service"`
	Severity     int            `json:"severity"`
	RiskFactor   string         `json:"risk_factor"`
	Description  string         `json:"description"`
	Solution     string         `json:"solution"`
	Output       string         `json:"output"`
	CVEs         datatypes.JSON `gorm:"type:jsonb" json:"cves"` // []string as JSONB
	CVSSScore    float64        `json:"cvss_score"`
	Refs         datatypes.JSON `gorm:"type:jsonb" json:"refs"` // []string as JSONB
	OwnerID      uuid.UUID      `gorm:"type:uuid;not null" json:"owner_id"`
	OwnerName    string         `gorm:"-" json:"owner_name"` // Not stored; loaded on query
}
