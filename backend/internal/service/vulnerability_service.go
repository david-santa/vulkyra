package service

import (
	"github.com/david-santa/vulkyra/backend/internal/models"
	"github.com/david-santa/vulkyra/backend/internal/repository"
	"gorm.io/gorm"
)

func GetAllVulnerabilities(db *gorm.DB) ([]models.Vulnerability, error) {
	return repository.GetAllVulnerabilities(db)
}

func GetTeamVulnerabilities(db *gorm.DB, teamID string) ([]models.Vulnerability, error) {
	return repository.GetTeamVulnerabilities(db, teamID)
}

func CreateVulnerability(db *gorm.DB, vuln *models.Vulnerability) error {
	return repository.CreateVulnerability(db, vuln)
}

func DeleteVulnerability(db *gorm.DB, vulnID string) error {
	return repository.DeleteVulnerability(db, vulnID)
}

func RecalculateVulnerabilityCounts(db *gorm.DB) error {
	return repository.RecalculateVulnerabilityCounts(db)
}
